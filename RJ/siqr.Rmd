---
title: Capitalized Title Here
author:
  - name: Author One
    affiliation: Affiliation
    address:
    - line 1
    - line 2
    email:  author1@work
  - name: Author Two
    affiliation: Affiliation
    address:
    - line 1
    - line 2
    email:  author2@work
abstract: >
  An abstract of less than 150 words.
preamble: |
  % Any extra LaTeX you need in the preamble
output: rticles::rjournal_article
---

## Real Rata and Simulations

### Boston Housing data

```{r}
#source the functions. Will be changed to load package
source("../R/SINDEXQ_fun.R")

#load data from MASS
library(MASS)
#help(Boston)
medv<- Boston$medv
RM <- Boston$rm
logTAX <- log(Boston$tax)
PTRATIO <- Boston$ptratio
logLSTAT <- log(Boston$lstat)

X <- cbind(RM,logTAX,PTRATIO,logLSTAT)
y0<-medv - mean(medv)

#result is not the same with Wu 2010 as initial was not normalized in Wu 2010
#tianhai
#gamma0 <- c(1,-1,0,-1);
gamma0 <- NULL
p_vec <- c(0.1,0.25,0.5,0.75,0.9)
est.coefficient <- matrix(NA, nrow = 5, ncol = 6)
est.coefficient[,1] <- p_vec
for (i in 1:length(p_vec)){
  est <- siqr(y0,X,gamma.inital = gamma0, p=p_vec[i],maxiter = 20,tol = 1e-6)
  est.coefficient[i,2:5] <- est$gamma
  est.coefficient[i,6]   <- est$MSAE
}
colnames(est.coefficient) <- c("quantile tau",colnames(X),"Model average sum of absolute residual")
est.coefficient

```

```{r}
#Wu 2010
gamma0 <- c(1,-1,0,-1);
p_vec <- c(0.1,0.25,0.5,0.75,0.9)
est.coefficient.Wu <- matrix(NA, nrow = 5, ncol = 6)
est.coefficient.Wu[,1] <- p_vec
for (i in 1:length(p_vec)){
  est <- siqr(y0,X,gamma.inital = gamma0, p=p_vec[i],maxiter = 20,tol = 1e-6, method = "Wu")
  est.coefficient.Wu[i,2:5] <- est$gamma
  est.coefficient.Wu[i,6]   <- est$MSAE
}
colnames(est.coefficient.Wu) <- c("quantile tau",colnames(X),"Model average sum of absolute residual")
est.coefficient.Wu
```

```{r}
est <- siqr(y0,X,gamma.inital = NULL, p=0.5)
plot.si(est)
```
```{r}
plot.si(est,bootstrap_interval = TRUE)
```


### Simulation


```{r eval = FALSE}
n <- 200
gamma0 <- c(1,2,3)
n_sim <- 100
p_vec <- c(0.1,0.25,0.5,0.75,0.9)

sim_results <- array(NA,dim = c(length(p_vec),ncol = 3,n_sim))
for(m in 1:n_sim){
  data <- generate_data(n)
  X <- data$X
  Y <- data$Y
  est.coefficient.sim <- matrix(NA, nrow = length(p_vec), ncol = NCOL(X))
  for (i in 1:length(p_vec)){
    est <- siqr(Y, X, gamma.inital = NULL, p=p_vec[i],maxiter = 30,tol = 1e-8)
    est.coefficient.sim[i,] <- est$gamma
  }
  sim_results[,,m] <- est.coefficient.sim
}
est.mean <- cbind(p_vec,apply(sim_results,c(1,2),mean))
colnames(est.mean) <- c("quantile tau","X1","X2","X3")
est.mean
```


```{r eval = FALSE}
#MC se
est.mean <- cbind(p_vec,apply(sim_results,c(1,2),sd))
colnames(est.mean) <- c("quantile tau","X1","X2","X3")
est.mean
```


```{r}
Sys.sleep(100)
```

\bibliography{RJreferences}
